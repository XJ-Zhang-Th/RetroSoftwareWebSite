<html>
<body style="font-size:9pt;line-height=150%" bgcolor="#FFFFF">
<p><span style="font-family:宋体;font-size:12pt">
主板复苏记</span>

</p>

<hr size="1" color="#000080"><br>
　　这几天玩电脑颇不顺利，懊恼总围绕着我，似乎是要逼迫我放弃电脑生涯。<br>
        　　先是升技（ABIT）BH6主板与我的“老”显卡联讯DSV3325过不去，逼着我不得不从早已干瘪的口袋中斥资购买了一块小影霸128AGP显卡（Riva128芯片），后又是在大众PT2006主板上用得很好的一块四倍速NEC光驱，在新的ABIT 
        BH6主板上却表现极差：昨天读得很好的光盘，今天却根本读不出。<br>
        　　人倒楣时，喝凉水都牙碜！ <strong></p>
        </strong></font><strong>黑 色 
        星 期 五</font></strong></p>
        　　公元一九九八年倒数第三个星期五（1998年12月18日），是我的一个黑色星期五！上班了，我照例按下了已经有点“老态龙钟”的微机的电源开关，电源指示灯由橙色变为黄色，但电脑最后却停留在“UPDATE 
        USCD”处，再也运行不下去了 。<br>
        　　又重新开机冷启动电脑，然而，就在这时，厄运已经降临了。显示器的电源指示灯再也不能由橙转黄，只听得PC 
        喇叭发出两声短促的“哀鸣”后，就再也无任何动静，显示器也无任何显示。<br>
        　　显示器电源指示灯持续为红色，说明无VGA信号传输到显示器，冷启动数次，故障依旧，心想可能是显示卡没有插好，又多次重新拔插显示卡，显示器仍“沉默”。<br>
        　　急呼W君带上好的显示卡（TRIO 64V＋），救吾于水火之中。插上新显示卡，开机，仍无显示，系统不能启动。<br>
        　　拆掉一条内存条，PC喇叭发出两声短促的报警声，重新插上内存条后，报警声又变了，初为急促且含糊不清的两声短响，紧接着又是一连串急促的“嘟嘟”声，显示器仍无显示。 
        <br>
        　　补充介绍一下这台“重症患机”（以下简称大众机）：该机购于1996年11月，配置为：大众PT2006主板（VX芯片组），CPU为Cyrix 
        6X86 PR133＋，16MB EDO RAM，IGS2000显示卡，昆腾大脚1.2G 硬盘。<br>
        　　无奈中，打电话找到发烧友H君。我详述了故障现象，探询感染CIH病毒的可能性。H君认为感染CIH病毒的可能性不大，因现在是18日，离各个版本的CIH病毒发作日期(25日、26日、27日)还远，而我的大众机的系统日期又是正确的。由于大众机在“UPDATE 
        USCD”处挂起，H君断然诊断我的主板已寿终正寝，此时的我已是不寒而栗了。虽然主板已被判“死刑”，但仍抱有一线希望，收拾起主板、硬盘、显示卡等来到W君处，逐个替换部件，确切诊断故障所在。</font></p>
        <strong>祸 不 单 行</font></strong></p>
        　　主要采取交叉替换法诊断故障所在。参考机为一台工作正常的电脑，主要配置为：GTC－STB8 
        TXPRO主板，Pentium 100 CPU，TRIO 64V＋显示卡，JTS硬盘，以下简称为旗舰机。<br>
        　　经过交叉替换诊断，发现IGS2000显卡、大脚硬盘及大众机电源均无故障。最后，测试大众机的CPU。按理说，既然大众机能正确检测到RAM故障，喇叭能发出报警声，CPU应该没有问题，但为进一步确定故障部位，仍将Cyrix 
        PR133＋CPU替换了旗舰机的Pentium 100 CPU，跳好跳线，反复检查无误后，再次启动计算机。另一片阴云降临了――原来完好的旗舰机再也启动不了，甚至连报警声也没有了。难道是Cyrix 
        6X86 PR133＋CPU坏了?将Pentium100插到大众PT2006主板上，重新跳线后启动，无报警声。看来，我的主板和CPU可能一起报销了，真是一个令人心碎的结论。然而，随后的实验证明，这还不是最悲惨的时刻。心情极端恶劣下，将旗舰机重新装好，按下电源开关。 
        三秒、五秒、十五秒……显示器无显示，换上一台正常使用的显示器，仍无显示，心中大叫不好，反复采用替换法修理，终告失败。<br>
        　　旗舰机也坏了！稀里糊涂中，与W君反复探讨，暂时的“结论”是：由于 
        Cyrix 6X86 PR133＋寿终正寝，连带损坏了大众主板PT2006，其后又由坏的Cyrix 
        6X86 PR133＋CPU将TXPRO主板损坏，最后的替换试验却使Pentium100 CPU被PT2006主板损坏。连损两块主板和两块CPU，真是祸不单行。</font></p>
        <strong>曙 光 初 现</font></strong></p>
        　　 
        后来偶然想到，插上一块传统的ISA总线显示卡能否有显示呢？嗯，手上正好有一块未处理掉的ISA显示卡，值得一试。赶紧从器材柜中找到了一块早已退役、尘封已久的老ISA显示卡TVGA8900。<br>
        　　将EDO RAM、Cyrix 6X86 PR133＋CPU、TVGA 8900显示卡、PT2006主板、开关电源、显示器连成一个最小系统，按下电源开关，殷切期盼中紧盯着显示器的电源指示灯，终于，在开机后约两秒钟，电源指示灯由红转绿，显示子系统终于不负众望，显示器显示出了自检信息：“ 
        BIOS CHECKSUM ERROR”！原来是BIOS检测出错，果真是BIOS有问题。<br>
        　　能补救吗？我的主板可是1996年出厂的啊！<br>
        　　系统继续报告：“FLOPY DISK DRIVER ERROR”。显然，系统在寻找软盘驱动器。<br>
        　　难道竟能给我这块“老”主板的BIOS升级？对，上网去，找BIOS升级程序和相应的写入程序。<br>
        　　坐在我那台历经磨难终成正果的赛扬300A电脑前，拨号入网，直奔大众公司的网站http://www.fic.com.tw，依照技术支持线索找到驱动程序区。PT2006主板的BIOS程序已从803J801.zip升至最新的807J802.zip。网页上赫然列出了各次升级的BIOS程序及其简要说明。赶紧将807J802.zip下载下来。</font></p>
        <strong>首 战 告 捷</font></strong></p>
        　　取出一张3英寸软盘，重新完全格式化，确认无坏道后，在DOS窗口中用SYS 
        C:A:命令传送系统文件，然后将807J802.zip用ZipMagic软件解压缩，产生三个文件：Readme.TXT、FLASH531.EXE、807J802.BIN，将它们拷贝到A盘中，再用杀毒软件仔细检查确定A盘无病毒后，标记磁盘，作好写保护，用其引导大众机，成功进入DOS系统。运行 
        FLASH531.EXE程序，按提示输入807J802.BIN文件名，系统警告：“Don't Turn 
        off Power Switch or Reset System(请勿关闭电源或重新启动系统)”。片刻后，显示写入字节数为7FFFFH，编程完毕。<br>
        　　关机重新启动，经过约3～4秒的时间，显示器电源指示灯由红转绿，显示卡已工作，系统终于修复，顺利地进入了Windows95。且慢，现在用的是TVGA8900卡，用原PCI显示卡IGS2000又会怎么样呢 
        ？插好IGS2000显示卡后，可正常启动。接上未作任何处理的硬盘和光盘驱动器，将大众机完全恢复原样，开机片刻后，欢快地进入了Windows95。大众机终于复苏了。<br>
        　　BIOS修复并升级后，大众机比以前稳定得多，再也没有间或启动不良的黑屏现象。原来我总认为是显示卡与主板兼容性之间有问题，换用过不同的显示卡，表现参差不齐，现在已可以肯定是主板BIOS出了问题。这次可是因祸得福了。</font></p>
        <strong>乘 胜 追 击</font></strong></p>
        　　高兴之余，决定乘胜追击，看看旗舰机TXPRO主板能否如法炮制。同样将TXPRO主板、Pentium 
        100 CPU、内存条、开关电源、TVGA8900 ISA显示卡、显示器组合成一个最小系统，开启电源，却大失所望。将Pentium 
        100 CPU装到大众机上，设好跳线，启动正常。排除了Pentium 100 CPU有问题的可能，了却一大心病，剩下的是诊断旗舰TXPRO主板损坏的部位与可修复性。<br>
        　　先将坏TXPRO主板的BIOS代替正常工作TXPRO主板的BIOS，该主板不能启动，坏TXPRO主板的BIOS的确有问题。咬紧牙关，将好TXPRO主板的BIOS换到坏主板上，通电，显示器一声轻响，1秒钟后，屏幕上显出了久违的系统自检信息。终于成功了！不，还有半步之遥。关闭电源，重新插上TRIO 
        64V＋ PCI显示卡，再次启动成功。<br>
        　　由于无法用坏的BIOS引导TXPRO主板，故不能采用修复大众机的方法，即用纯软件刷新的方法来修复BIOS。而采用热拔插法修复的危险性太大，首先不知道BIOS采用的ROM芯片类型，如果是UV 
        EPROM，但它并不支持纯软件刷新BIOS的方案；即使是FLASH EEPROM，在热拔插过程中，由于是带电操作，万一又将好的BIOS芯片损坏，就再也找不到TXPRO主板了，实在太冒险。故拟订了一个较为稳妥的方案：先找一片引脚兼容BIOS芯片的UV 
        EPROM，写入正常的BIOS程序，用其启动，成功后，如可能，再采用热拔插法，刷新原BIOS中的程序，达到完全修复的目的。<br>
        　　27C1001芯片是32脚DIP排列、容量为1Mb的UV EPROM，存储结构为128K × 
        8bit，与BIOS兼容，容量一样。先假定BIOS采用的ROM芯片与27C1001兼容。在编程器上设定ROM芯片型号为1Mb 
        27C1001，读出BIOS中的程序数据文件，并保存在磁盘上。用D命令查看读入缓冲区中的数据，可找到大段可理解信息，如BIOS版本号及日期、制造厂商名称等，如果在代码的最后可以看到“01_10_sis5577xx07/15/95”字样，则可基本肯定假定是对的，用写入了BIOS程序的27C1001替换应该没有问题。随即将缓冲区内容写入27C1001芯片，再将其插入到坏TXPRO主板的BIOS芯片插座上，开机，久未开颜的TXPRO系统终于露出了可爱的“笑颜”。<br>
        　　高兴得太早了。显示器依次显示出显示卡版本及类型信息、BIOS版本、主板芯片组、CPU型号等后出现错误信息：“CHECKING 
        NVRAM..NO NVRAM”，NVRAM是各类EEPROM和具有掉电保护功能的RAM的代名词，FLASH 
        EEPROM也是其中之一。那么。该主板采用的应是EEPROM。关机，挂上硬盘、光盘驱动器，开机。嘿！竟然黑屏，又启动失败了。奇怪，刚才还成功启动，现在为什么又不能启动呢？可能是BIOS又损坏了。<br>
        　　BIOS为什么又被损坏？一定是有高电平加到编程脚上，同时启动了写入程序。使用FLASH 
        EEPROM的主板具有写片能力，大多数FLASH EEPROM也采用12.5V编程电压。因此，一定是主板在更新BIOS时，将一些系统信息写入BIOS，由于BIOS芯片使用的是EPROM而非FLASH 
        EEPROM，写入时序不同，导致写入失败，致使BIOS再次损坏。<br>
        　　揭开UV EPROM紫外线照射窗口上的保护贴，置于擦除器中将数据擦除干净，再重新写入BIOS数据。<br>
        　　改造好27C1001后，插入BIOS插座，开机，旗舰机一路吟唱着走进了Windows95。运行各种应用软件无误。</font></p>
        <strong>小结</font></strong></p>
        　　既然查出了是BIOS的问题，联系到最近CIH病毒的猖獗，看来真相已大白：由于某种原因，我机器的硬盘被CIH病毒感染，不知是什么原因，它在CIH的非“法定发作日(25、26、27日)”发作，首先破坏了PT2006主板的BIOS，又由于某种原因，也许是幸运吧，它并没有损坏硬盘。在下一步的替换试验中，因为使用了带毒的硬盘，TXPRO系统在成功地启动以后，将BIOS破坏，致使TXPRO主板也被破坏，由于BIOS可以用内存映射，故当时机器仍正常，断电后，内存中映射的BIOS消失，因此，再也不能正常引导TXPRO系统了。<br>
        　　如各位读者有什么疑问，请与本人探讨，我的Email为：Zhanch@163.net。<br>
        (湖北　詹羽中)</font></p>
        <p align="right"><span class="ourfont"><font color="#369681">本文出自：</font><a
        href="index.htm">《电脑报》1999年02月08日第06期</a></span></td>
      </tr>
    </table>
    </center></div></td>
  </tr>
</table>
</center></div>
</body>
</html>
