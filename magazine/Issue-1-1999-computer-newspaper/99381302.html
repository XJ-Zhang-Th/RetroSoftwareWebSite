<html>
<body style="font-size:9pt;line-height=150%" bgcolor="#FFFFF">
<p><span style="font-family:宋体;font-size:12pt">
Delphi编程中实现动画鼠标</span>


<hr size="1" color="#000080"></p>
　　动画光标是以ANI为扩展名的文件,它的作用就是让你的鼠标外形变成动画,而不只是一个斜三角形，具体方法如下：<br>
　　新建一个工程,在FORM1上放一个BUTTON1,再找一个动画光标文件＊.ANI,你可以到网上下载一个,也可从一些光盘中找一个(如：查找＊.ANI文件),然后输入以下代码：<br>
　　unit CURSOR;<br>
　　interface<br>
　　uses  <br>
　　Windows, Messages, SysUtils, Classes, Graphics, Controls, Forms, Dialogs, StdCtrls;<br>
　　Type  TForm1 = class(TForm)<br>
　　Button1: TButton;<br>
　　procedure FormCreate(Sender: TObject);<br>
　　procedure FormClose(Sender: TObject; var Action: TCloseAction);<br>
　　procedure Button1Click(Sender: TObject);<br>
　　private    { Private declarations }<br>
　　public    { Public declarations }<br>
　　end;<br>
　　var<br>
　　Form1: TForm1;<br>
　　HOLDCURSOR:HCURSOR;  ′定义一个变量<br>
　　Implementation {＄R ＊.DFM}<br>
　　procedure TForm1.FormCreate(Sender: TObject);<br>
　　VAR<br>
　　HNEWCURSOR:HCURSOR;<br>
　　begin<br>
　　BUTTON1.CAPTION:=′关闭′;  <br>
　　HNEWCURSOR:=LOADCURSORFROMFILE(′E:\BATMAN.ANI′);  <br>
　　{调用API函数装载动画光标文件,ANI文件路径请根据自己的实际情况进行调整}<br>
　　HOLDCURSOR:=SETCLASSLONG(FORM1.HANDLE,GCL_HCURSOR,HNEWCURSOR);<br>
　　{把原光标储存起来以备以后的恢复}<br>
　　end;<br>
　　procedure TForm1.Button1Click(Sender: TObject);<br>
　　begin<br>
　　HOLDCURSOR:=SETCLASSLONG(FORM1.HANDLE,GCL_HCURSOR,HOLDCURSOR);<br>
　　CLOSE();  {在结束程序前一定不要忘记恢复光标}<br>
　　end;   <br>
　　end.<br>
　　现在你运行一下(按F9),启动后光标就变成动画光标了。<br><b>(上海　季昭君)</b><p align="right"><font COLOR="#000000">本文出自：<a href="index.htm">《电脑报》1999年09月27日第38期</a></font> 
</body>
</html>