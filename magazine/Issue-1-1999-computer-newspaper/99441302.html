<html>
<body style="font-size:9pt;line-height=150%" bgcolor="#FFFFF">
<p><span style="font-family:宋体;font-size:12pt">
用VB编程检测当前电池使用情况</span>


<hr size="1" color="#000080"></p>
　　你想知道你的机器当前电池使用情况吗?系统电池如电压不足将导致系统时间变慢等后果。所以你应该知道电池现在的状态，如电压不足则应该尽快去更换电池。用系统测试软件可以办到，但如果你没有也没关系，我们可以用VB编程来帮我们找到答案,具体做法如下：<br>
　　首先,新建一个工程,在其FORM1上新建二个COMMAND命令按钮(如COMMAND1和COMMAND2),再放上二个LABEL控件(如LABEL1和LABEL2),再装载一个WINDOWS SYSINFO CONTROL 5.0(请从工程菜单下部件对话框中选择并装载),其NAME为SYSINFO1,其他都不变,然后输入以下代码程序:<br>
　　Option Explicit  ′要求声明所有变量<br>
　　－－－－－－－－－－－－－<br>
　　Private Sub Form_Load()    ′做初始化设置<br>
　　Form1.Caption = ″检测电池状态演示程序″<br>
　　Command1.Caption = ″检测电池″<br>
　　Command2.Caption = ″退出″<br>
　　Label1.Caption = ″″ <br>
　　 Label1.AutoSize = True<br>
　　End Sub<br>
　　－－－－－－－－－－－－－<br>
　　Private Sub Command1_Click()   ′检测当前电池状态<br>
　　 Select Case SysInfo1.BatteryStatus <br>
　　Case 1: Label1.Caption = ″当前电池状态 :电池电压足″<br>
　　Case 2: Label1.Caption = ″当前电池状态 :电池电压不足″<br>
　　Case 4: Label1.Caption = ″当前电池状态 :电池快用完了″<br>
　　Case 128: Label1.Caption = ″当前电池状态 :无电池″<br>
　　Case 255: Label1.Caption = ″当前电池状态 :不知名″<br>
　　End Select<br>
　　End Sub<br>
　　－－－－－－－－－－－－－<br>
　　Private Sub Command2_Click()<br>
　　Unload Me  ′结束程序<br>
　　End<br>
　　End Sub<br>
　　运行该程序，不用调用任何的API函数就实现了这个功能。以上程序在中文WINDOWS98，中文VB5.0专业版中调试通过。<br><b>
　　（上海　季昭君）</b><p align="right"><font COLOR="#000000">本文出自：<a href="index.htm">《电脑报》1999年11月8日第44期</a></font> 
</body>
</html>