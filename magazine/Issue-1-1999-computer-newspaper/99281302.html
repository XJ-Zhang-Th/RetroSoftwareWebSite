<html>
<body style="font-size:9pt;line-height=150%" bgcolor="#FFFFF">
<p><span style="font-family:宋体;font-size:12pt">
FoxPro编程小技巧</span>


<hr size="1" color="#000080"></p>
　　<B>1．在VFP5.0的报表设计器中，通过编程实现打印数据颜色的变化（如：正数打印黑色，负数打印红色等）</B><BR>　　对同一个变量（字段），如金额，在报表上做两个域控件，它们是重叠的，一个黑色，一个红色，双击红色控件调出报表表达式设置框，按“打印条件”，在出现的设置框中的“仅当下列表达式为真时打印”中输入“金额&lt; 
      0”，同理黑色的就输入“金额&gt;=0”，这样大于等于0就打印黑色的，反之打印红色的。<BR>　　<B>2．制作VFP5.0安装程序，使其运行安装结束后在“开始”菜单上建立程序组</B><BR>　　如果在向导的第6步中没有指定程序管理器项，就应该将.exe文件指定为程序管理器项，单击该文件所在行的程序管理器项中的check按钮，在弹出的窗口中输入说明和命令行，命令行输入：％s\xxx.exe，xxx.exe为您的.exe文件名，％s是为了保证程序在安装时改变了目录也能正常运行，另还可选择图标。<BR>　　<B>3．将程序中随机生成的表或游标加入到数据环境中，并用表格控件显示</B><BR>　　1）表格与数据环境中一个表A对应，程序中随机生成表B后，将表A清空，将B的数据全部放入A。<BR>　　2）表格以及列的ControlSource不要设数据表别名，列的ControlSource只有字段名，那么当程序随机生成表的字段与表对应上以后就可以显示了。<BR>　　3）以上两种方法适用于编程时知道随机表的字段情况，如字段都是随机的，无法预先知道，那么就只有用表格的addcolumn方法，即根据随机生成的表临时向表格中添加列。当然预先知道字段的情况下也可用此方法。<BR>　　另外可以使用视图或者使用SQL语言。<BR>　　<B>4．将winhelp写的帮助文件连接到菜单上</B><BR>　　在你的程序菜单中用“插入栏”插入“Microsoft 
      Visual FoxPro 帮助主题(\<V)”，当然你可以把菜单名改为“帮助主题”，或者其它名字都可以，然后用如下命令：SET 
      xxx.hlp把系统帮助文件设为你的文件(xxx.help为你的帮助文件名)。<br to hlp> 
      　　5．通过OLE控件和宏实现数据表内GENERAL字段中的图片自动备份到硬盘上<BR>　　1）制作一个宏，{alt＋f}a；<BR>　　2）添加OLE控件，在表单中执行方法DoVerb，如：thisform.OleObject.DoVerb(－1)；<BR>　　3）然后播放宏，就可以得到“另存为”窗口；<BR>　　4）可以在表单上添加一些按钮，便于操作；<BR>　　5）如果知道OLE服务器的动作集，在DoVerb直接送参数就可以实现自动存盘。<BR><B>（风帆）</B><p align="right"><font COLOR="#000000">本文出自：<a href="index.htm">《电脑报》1999年07月19日第28期</a></font> 
</body>
</html>