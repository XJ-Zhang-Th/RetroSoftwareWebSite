<html>
<body style="font-size:9pt;line-height=150%" bgcolor="#FFFFF">
<p><span style="font-family:宋体;font-size:12pt">
“彩蝶”伴“鼠”飞</span>


<hr size="1" color="#000080"></p>
　　我们都想使自己的程序有一些与众不同的东西，让第一次使用的人感到新奇。把下面的代码加入你的VB程序中，就能使程序运行时鼠标旁边有4个彩蝶在翩翩起舞。<br>
　　Private Sub Form_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)<br>
　　DrawWidth = 5<br>
　　Static CX(3) As Single, cy(3) As Single′用Static声明的变量可在过程重启时仍保存上次的值<br>
　　Dim xx(3) As Single, yy(3) As Single<br>
　　Dim i As Integer<br>
　　For i = 0 To 3<br>
　　PSet (CX(i), cy(i)), Me.BackColor′用背景色画点,将上次画的彩点覆盖掉<br>
　　′取以鼠标为圆心250为半径的圆内的随机点<br>
　　xx(i) = (Rnd ＊ 500 － 250) ＋ X<br>
　　yy(i) = (Rnd ＊ 500 － 250) ＋ Y<br>
　　Next i<br>
　　For i = 0 To 3<br>
　　PSet (xx(i), yy(i)), RGB(Rnd ＊ 255, Rnd ＊ 255, Rnd ＊ 255)'画4个颜色随机变化的彩点<br>
　　′保存4个随机点的位置,以便下个MouseMove事件中能通过画背景色的点来覆盖它们<br>
　　CX(i) = xx(i)<br>
　　cy(i) = yy(i)<br>
　　Next i<br>
　　DrawWidth = 1<br>
　　End Sub<br>
　　如果在窗体上有Label控件,彩点会把它们擦掉,我们可以判断出随机点是否接近Label控件,从而决定是否画彩点。例如有三个Label控件，将下面代码替掉斜体部分就能使Label控件不受影响。<br>
　　For i = 0 To 3<br>
　　If (xx(i) &lt;= Label1.Left － 30 Or yy(i) &lt;= Label1.Top － 30 Or yy(i) &gt;= Label1.Top ＋ Label1.Height ＋ 30 Or xx(i) &gt;= Label1.Left ＋ Label1.Width ＋ 30) _<br>
　　And (xx(i) &lt;= Label2.Left － 30 Or yy(i) &lt;= Label2.Top － 30 Or yy(i) &gt;= Label2.Top ＋ Label2.Height ＋ 30 Or xx(i) &gt;= Label2.Left ＋ Label2.Width ＋ 30) _<br>
　　And (xx(i) &lt;= Label3.Left － 30 Or yy(i) &lt;= Label3.Top － 30 Or yy(i) &gt;= Label3.Top ＋ Label3.Height ＋ 30 Or xx(i) &gt;= Label3.Left ＋ Label3.Width ＋ 30) Then′如彩点不在Label控件范围内<br>
　　PSet (xx(i), yy(i)), RGB(Rnd ＊ 255, Rnd ＊ 255, Rnd ＊ 255)′画4个颜色随机变化的彩点<br>
　　Else    ′在Label控件范围内则不画点<br>
　　xx(i) = 0<br>
　　yy(i) = 0<br>
　　End If<br><b>(江西　程志刚)</b><p align="right"><font COLOR="#000000">本文出自：<a href="index.htm">《电脑报》1999年10月18日第41期</a></font> 
</body>
</html>